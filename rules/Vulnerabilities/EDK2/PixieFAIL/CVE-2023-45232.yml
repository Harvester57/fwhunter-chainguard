CVE-2023-45232:
  meta:
    author: Binarly (https://github.com/binarly-io/FwHunt)
    license: CC0-1.0
    name: CVE-2023-45232
    namespace: vulnerabilities
    advisory: https://blog.quarkslab.com/pixiefail-nine-vulnerabilities-in-tianocores-edk-ii-ipv6-network-stack.html
    description: Infinite loop when parsing unknown options in the Destination Options header
    CVSS score: 7.5 High
    architecture: X86:LE:64
    tags:
      - kind: sdk
        value: EDK2
    volume guids:
      - 5BEDB5CC-D830-4EB2-8742-2D4CC9B54F2C
  variants:
    variant1:
      code:
        - pattern: 0fb64424..25........894424..837c24....74..837c24....74..817c24..........74..817c24..........0f84........e9........0fb65424..0fb64c24..488b4424..0fb64c08..8bc203c1884424..e9
            # 0fb6442441                          movzx   eax, [rsp+58h+OptionType]
            # 25c0000000                          and     eax, 0C0h
            # 89442448                            mov     [rsp+58h+var_10], eax
            # 837c244800                          cmp     [rsp+58h+var_10], 0
            # 7424                                jz      short loc_1645B
            # 837c244840                          cmp     [rsp+58h+var_10], 40h ; '@'
            # 743e                                jz      short loc_1647C
            # 817c244880000000                    cmp     [rsp+58h+var_10], 80h
            # 743b                                jz      short loc_16483
            # 817c2448c0000000                    cmp     [rsp+58h+var_10], 0C0h
            # 0f8482000000                        jz      loc_164D8
            # e9e6000000                          jmp     loc_16541
            # 0fb6542440                          movzx   edx, [rsp+58h+Offset]
            # 0fb64c2440                          movzx   ecx, [rsp+58h+Offset]
            # 488b442470                          mov     rax, [rsp+58h+arg_10]
            # 0fb64c0801                          movzx   ecx, byte ptr [rax+rcx+1]
            # 8bc2                                mov     eax, edx
            # 03c1                                add     eax, ecx
            # 88442440                            mov     [rsp+58h+Offset], al
            # e9c5000000                          jmp     loc_16541
    variant2:
      code:
        - pattern: 450fb6c2410fb60c188bd185c974..83ea..74..83fa..74..81e1........74..83e9..74..83e9..74..83f9..75..4d8b4b..41807918ff74..eb..4502541801eb
            # 450fb6c2                            movzx   r8d, r10b
            # 410fb60c18                          movzx   ecx, byte ptr [r8+rbx]
            # 8bd1                                mov     edx, ecx
            # 85c9                                test    ecx, ecx
            # 7447                                jz      short loc_C949
            # 83ea01                              sub     edx, 1
            # 7436                                jz      short loc_C93D
            # 83fa04                              cmp     edx, 4
            # 742b                                jz      short loc_C937
            # 81e1c0000000                        and     ecx, 0C0h
            # 741c                                jz      short loc_C930
            # 83e940                              sub     ecx, 40h ; '@'
            # 747d                                jz      short loc_C996
            # 83e940                              sub     ecx, 40h ; '@'
            # 7440                                jz      short loc_C95E
            # 83f940                              cmp     ecx, 40h ; '@'
            # 7529                                jnz     short loc_C94C
            # 4d8b4b20                            mov     r9, [r11+20h]
            # 41807918ff                          cmp     byte ptr [r9+18h], 0FFh
            # 7468                                jz      short loc_C996
            # eb32                                jmp     short loc_C962
            # 4502541801                          add     r10b, [r8+rbx+1]
            # eb15                                jmp     short loc_C94C
