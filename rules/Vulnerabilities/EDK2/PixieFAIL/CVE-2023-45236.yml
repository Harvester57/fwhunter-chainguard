CVE-2023-45236:
  meta:
    author: Binarly (https://github.com/binarly-io/FwHunt)
    license: CC0-1.0
    name: CVE-2023-45236
    namespace: vulnerabilities
    advisory: https://blog.quarkslab.com/pixiefail-nine-vulnerabilities-in-tianocores-edk-ii-ipv6-network-stack.html
    description: Predictable TCP Initial Sequence Numbers
    CVSS score: 5.8 High
    architecture: X86:LE:64
    tags:
      - kind: sdk
        value: EDK2
    volume guids:
      - 1A7E4468-2F55-4A56-903C-01265EB7622B
  variants:
    variant1:
      code:
        and:
          - pattern: 8b4424..69c0........05........33d2b9........f7f18bc233d2f735........8915........8b4424
              # 8b442448                            mov     eax, [rsp+58h+var_10]
              # 69c06d4ec641                        imul    eax, 41C64E6Dh
              # 0539300000                          add     eax, 3039h
              # 33d2                                xor     edx, edx
              # b9ffffffff                          mov     ecx, 0FFFFFFFFh
              # f7f1                                div     ecx
              # 8bc2                                mov     eax, edx
              # 33d2                                xor     edx, edx
              # f735980f0200                        div     cs:mTcpGlobalIss
              # 8915920f0200                        mov     cs:mTcpGlobalIss, edx
              # 8b442448                            mov     eax, [rsp+58h+var_10]
          - pattern: 8b05........05........8905........8b05........
              # 8b055ea10100                        mov     eax, cs:mTcpGlobalIss
              # 0500080000                          add     eax, 800h
              # 890553a10100                        mov     cs:mTcpGlobalIss, eax
              # 8b054da10100                        mov     eax, cs:mTcpGlobalIss
          - pattern: 8b05........83c0..8905........488b05
              # 8b0586b10100                        mov     eax, cs:mTcpGlobalIss
              # 83c064                              add     eax, 64h ; 'd'
              # 89057db10100                        mov     cs:mTcpGlobalIss, eax
              # 488b05cab10100                      mov     rax, cs:off_21A88
    variant2:
      code:
        and:
          - pattern: 03cb69c1........83c9..05........f7f18bca33d28bc1f735........b8........6623c88915
              # 03cb                                add     ecx, ebx
              # 69c16d4ec641                        imul    eax, ecx, 41C64E6Dh
              # 83c9ff                              or      ecx, 0FFFFFFFFh
              # 0539300000                          add     eax, 3039h
              # f7f1                                div     ecx
              # 8bca                                mov     ecx, edx
              # 33d2                                xor     edx, edx
              # 8bc1                                mov     eax, ecx
              # f735c6a60000                        div     cs:mTcpGlobalIss
              # b8ff030000                          mov     eax, 3FFh
              # 6623c8                              and     cx, ax
              # 8915b8a60000                        mov     cs:mTcpGlobalIss, edx
          - pattern: 8b05........05
              # 8b05228b0000                        mov     eax, cs:mTcpGlobalIss
              # 0500080000                          add     eax, 800h
          - pattern: 8305
              # 8305f167000064                      add     cs:mTcpGlobalIss, 64h ; 'd'
