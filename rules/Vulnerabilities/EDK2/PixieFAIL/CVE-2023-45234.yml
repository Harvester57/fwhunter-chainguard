CVE-2023-45234:
  meta:
    author: Binarly (https://github.com/binarly-io/FwHunt)
    license: CC0-1.0
    name: CVE-2023-45234
    namespace: vulnerabilities
    advisory: https://blog.quarkslab.com/pixiefail-nine-vulnerabilities-in-tianocores-edk-ii-ipv6-network-stack.html
    description: Buffer overflow when processing DNS Servers option in a DHCPv6 Advertise message
    CVSS score: 8.3 High
    architecture: X86:LE:64
    tags:
      - kind: sdk
        value: EDK2
    volume guids:
      - B95E9FDA-26DE-48D2-8807-1F9107AC5E3A
  variants:
    variant1:
      code:
        - pattern: 488b4424..488b80........0fb748..e8........0fb7c8e8........4c8bd8488b4424..4c8998........488b4424..4883b8..........75..48b8................e9........488b5424..488b92........4883c2..41b8........488b4c24..488b89........e8
              # 488b442428                          mov     rax, [rsp+58h+var_30]
              # 488b80f0050000                      mov     rax, [rax+5F0h]
              # 0fb74802                            movzx   ecx, word ptr [rax+2]
              # e8c21f0000                          call    sub_13E30
              # 0fb7c8                              movzx   ecx, ax; AllocationSize
              # e89a460000                          call    AllocateZeroPool
              # 4c8bd8                              mov     r11, rax
              # 488b442460                          mov     rax, [rsp+58h+arg_0]
              # 4c8998a82b0000                      mov     [rax+2BA8h], r11
              # 488b442460                          mov     rax, [rsp+58h+arg_0]
              # 4883b8a82b000000                    cmp     qword ptr [rax+2BA8h], 0
              # 750f                                jnz     short loc_11EA3
              # 48b80900000000000080                mov     rax, 8000000000000009h
              # e9ff020000                          jmp     loc_121A2
              # 488b542428                          mov     rdx, [rsp+58h+var_30]
              # 488b92f0050000                      mov     rdx, [rdx+5F0h]
              # 4883c204                            add     rdx, 4; SourceBuffer
              # 41b810000000                        mov     r8d, 10h; Length
              # 488b4c2460                          mov     rcx, [rsp+58h+arg_0]
              # 488b89a82b0000                      mov     rcx, [rcx+2BA8h]; DestinationBuffer
              # e8561b0000                          call    CopyMem
    variant2:
      code:
        - pattern: 0fb740..66c1c0..0fb7c8e8........488983........4885c075..48b8................e9........488b942b........4883c2..483bc274..41b8........488bc8e8
              # 0fb74002                            movzx   eax, word ptr [rax+2]
              # 66c1c008                            rol     ax, 8
              # 0fb7c8                              movzx   ecx, ax; AllocationSize
              # e8ed140000                          call    AllocateZeroPool
              # 488983a82b0000                      mov     [rbx+2BA8h], rax
              # 4885c0                              test    rax, rax
              # 750f                                jnz     short loc_AB16
              # 48b80900000000000080                mov     rax, 8000000000000009h
              # e9cc010000                          jmp     loc_ACE2
              # 488b942b70460000                    mov     rdx, [rbx+rbp+4670h]
              # 4883c204                            add     rdx, 4; SourceBuffer
              # 483bc2                              cmp     rax, rdx
              # 740e                                jz      short loc_AB35
              # 41b810000000                        mov     r8d, 10h; Length
              # 488bc8                              mov     rcx, rax; DestinationBuffer
              # e84b57ffff                          call    CopyMem
