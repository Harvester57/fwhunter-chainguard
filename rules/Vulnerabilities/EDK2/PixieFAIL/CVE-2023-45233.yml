CVE-2023-45233:
  meta:
    author: Binarly (https://github.com/binarly-io/FwHunt)
    license: CC0-1.0
    name: CVE-2023-45233
    namespace: vulnerabilities
    advisory: https://blog.quarkslab.com/pixiefail-nine-vulnerabilities-in-tianocores-edk-ii-ipv6-network-stack.html
    description: Infinite loop when parsing a PadN option in the Destination Options header
    CVSS score: 7.5 High
    architecture: X86:LE:64
    tags:
      - kind: sdk
        value: EDK2
    volume guids:
      - 5BEDB5CC-D830-4EB2-8742-2D4CC9B54F2C
  variants:
    variant1:
      code:
        and:
          - pattern: 807c24....74
              # 807c244401                          cmp     [rsp+58h+var_14], 1
              # 7419                                jz      short loc_163F0
          - pattern: 0fb65424..0fb64c24..488b4424..0fb64408..8d4402..884424..e9
              # 0fb6542440                          movzx   edx, [rsp+58h+Offset]
              # 0fb64c2440                          movzx   ecx, [rsp+58h+Offset]
              # 488b442470                          mov     rax, [rsp+58h+arg_10]
              # 0fb6440801                          movzx   eax, byte ptr [rax+rcx+1]
              # 8d440202                            lea     eax, [rdx+rax+2]
              # 88442440                            mov     [rsp+58h+Offset], al
              # e930010000                          jmp     loc_16541
    variant2:
      code:
        and:
          - pattern: 450fb6c2410fb60c188bd185c974..83ea..74
              # 450fb6c2                            movzx   r8d, r10b
              # 410fb60c18                          movzx   ecx, byte ptr [r8+rbx]
              # 8bd1                                mov     edx, ecx
              # 85c9                                test    ecx, ecx
              # 7447                                jz      short loc_C949
              # 83ea01                              sub     edx, 1
              # 7436                                jz      short loc_C93D
          - pattern: 418a44180104..4402d0eb
              # 418a441801                          mov     al, [r8+rbx+1]
              # 0402                                add     al, 2
              # 4402d0                              add     r10b, al
              # eb03                                jmp     short loc_C94C
